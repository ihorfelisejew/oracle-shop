<div class="catalog-page__container" style="padding-top: 180px;">
  <nav class="breadcrumbs">
    <a href="{{ shop.url }}">Home</a>

    {% assign current_name = collection.title | default: product.title %}
    {% assign breadcrumb_links = "" %}
    {% assign breadcrumb_urls = "" %}

    {% for link in linklists.main-menu.links %}
      {% assign found = false %}

      {% if link.title == current_name %}
        {% assign breadcrumb_links = link.title %}
        {% assign breadcrumb_urls = "" %}
        {% assign found = true %}
      {% else %}
        {% for child in link.links %}
          {% if child.title == current_name %}
            {% assign breadcrumb_links = link.title | append: " / " | append: child.title %}
            {% assign breadcrumb_urls = link.url %}
            {% assign found = true %}
          {% else %}
            {% for grandchild in child.links %}
              {% if grandchild.title == current_name %}
                {% assign breadcrumb_links = link.title | append: " / " | append: child.title | append: " / " | append: grandchild.title %}
                {% assign breadcrumb_urls = link.url | append: "," | append: child.url %}
                {% assign found = true %}
              {% endif %}
            {% endfor %}
          {% endif %}
        {% endfor %}
      {% endif %}

      {% if found %}
        {% assign crumbs = breadcrumb_links | split: " / " %}
        {% assign urls = breadcrumb_urls | split: "," %}
        {% assign last_index = crumbs.size | minus: 1 %}

        {% for crumb in crumbs %}
          {% assign index = forloop.index0 %}
          <span class="separator">
            &gt;
          </span>
          {% if index < last_index %}
            <a href="{{ urls[index] }}">{{ crumb }}</a>
          {% else %}
            <span class="current-page">
              {{ crumb }}
            </span>
          {% endif %}
        {% endfor %}
        {% break %}
      {% endif %}
    {% endfor %}
  </nav>
  <h1 class="catalog-page__title page__title">{{ collection.title }}</h1>
  {% if section.settings.show_description %}
    <p class="collection-description">{{ collection.description }}</p>
  {% endif %}
  <div class="products-list">
    {% paginate collection.products by 12 %}
      {% for product_item in collection.products %}
        {# Змінено ім'я змінної #}
        <div class="product-list__item">
          <a href="{{ product_item.url }}" class="image__block">
            {%- if product_item.tags contains 'New' -%}
              <span class="product__label">New</span>
            {%- endif -%}
            <img
              src="{{ product_item.featured_image | img_url: '300x' }}"
              alt="{{ product_item.title | escape }}"
              loading="lazy"
              width="300"
              height="{{ 300 | divided_by: product_item.featured_image.aspect_ratio | round }}">
            <span class="view-more">View More</span>
          </a>
          <a href="{{ product_item.url }}" class="product__name">{{ product_item.title }}</a>
          <p class="product__price">
            {{ product_item.price | money }}
            {%- if product_item.compare_at_price > product_item.price -%}
              <span class="old-price">{{ product_item.compare_at_price | money }}</span>
            {%- endif -%}
          </p>
        </div>
      {% endfor %}

      {% if paginate.pages > 1 %}
        <div class="pagination">
          {% if paginate.previous %}
            <a href="{{ paginate.previous.url }}">Previous</a>
          {% endif %}

          {% for part in paginate.parts %}
            {% if part.is_link %}
              <a href="{{ part.url }}">{{ part.title }}</a>
            {% else %}
              <span>{{ part.title }}</span>
            {% endif %}
          {% endfor %}

          {% if paginate.next %}
            <a href="{{ paginate.next.url }}">Next</a>
          {% endif %}
        </div>
      {% endif %}

    {% endpaginate %}
  </div>
</div>